function setCookie(name,value,days){let expires="";if(days){let date=new Date;date.setTime(date.getTime()+days*24*60*60*1e3);expires="; expires="+date.toUTCString()}document.cookie=name+"="+value+expires+"; path=/; SameSite=None; Secure"}function getCookie(name){let nameEQ=name+"=";let ca=document.cookie.split(";");for(let i=0;i<ca.length;i++){let c=ca[i];while(c.charAt(0)==" ")c=c.substring(1,c.length);if(c.indexOf(nameEQ)==0)return c.substring(nameEQ.length,c.length)}return null}function eraseCookie(name){document.cookie=name+"=; Max-Age=-99999999;"}function validateURL(str){let pattern=new RegExp("^(https?:\\/\\/)?"+"((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|"+"((\\d{1,3}\\.){3}\\d{1,3}))"+"(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*"+"(\\?[;&a-z\\d%_.~+=-]*)?"+"(\\#[-a-z\\d_]*)?$","i");return!!pattern.test(str)}const wabiSrc=document.currentScript.src;const wabiPath=wabiSrc.substring(0,wabiSrc.lastIndexOf("/"));const wabiLGPD=function(options){const t=this;t.opt=Object.assign({},wabiLGPD.Defaults,options);t.showDialogButton=document.querySelectorAll(".wabi-lgpd-show-dialog");t.onOffText=[{id:"strictlyNecessary"},{id:"performanceCookies"},{id:"functionalCookies"},{id:"targetingCookies"}];t.allowedLanguages=["pt","en","es"];setCookie(t.opt.name+"strictlyNecessary",true,t.opt.expire);if(!getCookie(t.opt.name)){setCookie("wabiShowDialog",true,t.opt.expire)}if(getCookie("wabiShowDialog")=="true"){setCookie(t.opt.name,t.opt.initialConsent,t.opt.expire);if(t.onOffText){for(let i=0;i<t.onOffText.length;i++){let s=t.onOffText[i];if(s.id!="strictlyNecessary"){setCookie(t.opt.name+s.id,t.opt.initialConsent,t.opt.expire)}}}}if(validateURL(t.opt.privacyPolicyUrl)===false){throw new Error("LGPD Cookies: Error loading privacy policy url")}else if(!t.allowedLanguages.includes(t.opt.lang)){throw new Error("LGPD Language: Error loading translations")}else if(t.opt.analytics===true&&(typeof t.opt.analyticsID=="undefined"||t.opt.analyticsID=="")){throw new Error("LGPD Analytics: Configure a valid ID")}else if(t.opt.adsense===true&&(typeof t.opt.adsenseID=="undefined"||t.opt.adsenseID=="")){throw new Error("LGPD Adsense: Configure a valid ID")}else{t.init()}};wabiLGPD.Defaults={name:"wabiConsentLGPD",initialConsent:false,expire:365,lang:"pt",showDecline:true,showSettings:true,analytics:false,adsense:false};wabiLGPD.prototype.loadAnalytics=function(e){const t=this;t.analytics=document.createElement("script");t.analytics.async=true;t.analytics.src="https://www.googletagmanager.com/gtag/js?id="+t.opt.analyticsID;document.head.appendChild(t.analytics);t.analytics.onload=function(){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date);gtag("config",t.opt.analyticsID)}};wabiLGPD.prototype.loadAdsense=function(e){const t=this;t.adsense=document.createElement("script");t.adsense.async=true;t.adsense.src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client="+t.opt.adsenseID;t.adsense.crossorigin="anonymous";document.head.appendChild(t.adsense);t.adsense.onload=function(){t.adsenseManualAds=document.querySelectorAll('ins.adsbygoogle:not([class*=" "])');for(let i=0;i<t.adsenseManualAds.length;i++){try{(adsbygoogle=window.adsbygoogle||[]).push({})}catch(error){}}}};wabiLGPD.prototype.consent=function(e){const t=this;setCookie(t.opt.name,true,t.opt.expire);if(t.onOffItems){for(let i=0;i<t.onOffItems.length;i++){let s=t.onOffItems[i];setCookie(t.opt.name+s.id,true,t.opt.expire);s.checked=true}}t.closeSettings(e);t.closeDialog();if(t.opt.analytics&&typeof t.analytics=="undefined")t.loadAnalytics();if(t.opt.adsense&&typeof t.adsense=="undefined")t.loadAdsense()};wabiLGPD.prototype.confirmChoices=function(e){const t=this;let consent=true;for(let i=0;i<t.onOffItems.length;i++){let s=t.onOffItems[i];setCookie(t.opt.name+s.id,s.checked,t.opt.expire);if(s.checked===false){consent=false}if(s.checked==true){if(s.id=="performanceCookies"&&t.opt.analytics&&typeof t.analytics=="undefined"){t.loadAnalytics()}if(s.id=="targetingCookies"&&t.opt.adsense&&typeof t.adsense=="undefined"){t.loadAdsense()}}}setCookie(t.opt.name,consent,t.opt.expire);setCookie("wabiShowDialog",false,t.opt.expire);t.closeSettings(e);t.closeDialog()};wabiLGPD.prototype.decline=function(e){const t=this;setCookie(t.opt.name,false,t.opt.expire);for(let i=0;i<t.onOffItems.length;i++){let s=t.onOffItems[i];if(s.id!="strictlyNecessary"){setCookie(t.opt.name+s.id,false,t.opt.expire);s.checked=false}}t.closeDialog()};wabiLGPD.prototype.settings=function(e){const t=this;t.dialog.classList.remove("active");t.settingsDialog.classList.add("active")};wabiLGPD.prototype.closeSettings=function(e){const t=this;e.preventDefault();t.dialog.classList.add("active");if(t.opt.showSettings){t.settingsDialog.classList.remove("active")}};wabiLGPD.prototype.toogleAccordion=function(s,e){if(e.target.classList.contains("wabiLGPD-settings-text")){s.nextElementSibling.classList.toggle("active")}};wabiLGPD.prototype.logCookies=function(e){const t=this;console.log("Consent All: "+getCookie(t.opt.name));console.log("Show Dialog: "+getCookie("wabiShowDialog"));if(t.onOffText){for(let i=0;i<t.onOffText.length;i++){let s=t.onOffText[i];console.log(s.id+": "+getCookie(t.opt.name+s.id))}}};wabiLGPD.prototype.newDialog=function(e){const t=this;t.container=document.createElement("div");t.container.className="wabiLGPD-container active";document.body.appendChild(t.container);t.dialog=document.createElement("div");t.dialog.className="wabiLGPD-dialog active";t.container.appendChild(t.dialog);t.dialogMessageContainer=document.createElement("div");t.dialogMessageContainer.className="wabiLGPD-message";t.dialog.appendChild(t.dialogMessageContainer);t.dialogTitle=document.createElement("h1");t.dialogTitle.innerHTML=t.lang.dialogTitle;t.dialogMessageContainer.appendChild(t.dialogTitle);t.dialogMessage=document.createElement("p");t.dialogMessage.innerHTML=t.lang.message[langModifier]+" ";t.dialogMessageContainer.appendChild(t.dialogMessage);t.privacyPolicyP=document.createElement("p");t.privacyPolicyP.className="text-center";t.dialogMessageContainer.appendChild(t.privacyPolicyP);t.privacyPolicyUrl=document.createElement("a");t.privacyPolicyUrl.href=t.opt.privacyPolicyUrl;t.privacyPolicyUrl.innerHTML=t.lang.learnMore;t.privacyPolicyP.appendChild(t.privacyPolicyUrl);t.dialogButtons=document.createElement("div");t.dialogButtons.className="wabiLGPD-buttons";t.dialog.appendChild(t.dialogButtons);t.consentButton=document.createElement("button");t.consentButton.className="wabiLGPD-btn wabiLGPD-btn-consent";t.consentButton.innerHTML=t.lang.consent[langModifier];t.dialogButtons.appendChild(t.consentButton);if(t.opt.showDecline){t.declineButton=document.createElement("button");t.declineButton.className="wabiLGPD-btn wabiLGPD-btn-decline";t.declineButton.innerHTML=t.lang.decline;t.dialogButtons.appendChild(t.declineButton)}if(t.opt.showSettings){t.settingsButton=document.createElement("button");t.settingsButton.className="wabiLGPD-btn wabiLGPD-btn-settings";t.settingsButton.innerHTML=t.lang.settings;t.dialogButtons.appendChild(t.settingsButton)}};wabiLGPD.prototype.showDialog=function(e){const t=this;e.preventDefault();t.container.classList.add("active")};wabiLGPD.prototype.closeDialog=function(e){const t=this;t.container.classList.remove("active");setCookie("wabiShowDialog",false,t.opt.expire)};wabiLGPD.prototype.newSettingsDialog=function(e){const t=this;t.settingsDialog=document.createElement("div");t.settingsDialog.className="wabiLGPD-settings";t.container.appendChild(t.settingsDialog);t.settingsDialogTitle=document.createElement("h1");t.settingsDialogTitle.innerHTML=t.lang.settingsDialogTitle;t.settingsDialog.appendChild(t.settingsDialogTitle);t.settingsCloseButton=document.createElement("a");t.settingsCloseButton.href="";t.settingsCloseButton.className="wabiLGPD-close-btn";t.settingsCloseButton.innerHTML="&#x02a2f;";t.settingsDialog.appendChild(t.settingsCloseButton);t.settingsDialogMessage=document.createElement("p");t.settingsDialogMessage.innerHTML=t.lang.settingsDialogMessage;t.settingsDialog.appendChild(t.settingsDialogMessage);t.settingsDialogAccordion=document.createElement("div");t.settingsDialogAccordion.className="wabiLGPD-accordion";t.settingsDialog.appendChild(t.settingsDialogAccordion);t.accordionItems=[];t.onOffItems=[];for(let i=0;i<t.onOffText.length;i++){let item=document.createElement("div");item.className="wabiLGPD-accordion-item";t.settingsDialogAccordion.appendChild(item);let itemHeader=document.createElement("div");itemHeader.className="wabiLGPD-accordion-item-header";item.appendChild(itemHeader);let text=document.createElement("div");text.className="wabiLGPD-settings-text";text.innerHTML=t.onOffText[i].lang+" &#8595;";itemHeader.appendChild(text);let onOff=document.createElement("div");onOff.className="wabiLGPD-on-off";itemHeader.appendChild(onOff);let onOffLabel=document.createElement("label");onOff.appendChild(onOffLabel);let cookie=getCookie(t.opt.name+t.onOffText[i].id);let onOffCheckbox=document.createElement("input");onOffCheckbox.type="checkbox";onOffCheckbox.id=t.onOffText[i].id;if(t.onOffText[i].id=="strictlyNecessary"){onOffCheckbox.checked=true;onOffCheckbox.disabled=true}else if(cookie=="true"||cookie===null&&t.opt.initialConsent===true){onOffCheckbox.checked=true}onOffLabel.appendChild(onOffCheckbox);let onOffSpan=document.createElement("span");onOffLabel.appendChild(onOffSpan);let body=document.createElement("div");body.className="wabiLGPD-accordion-body";item.appendChild(body);let bodyText=document.createElement("div");bodyText.innerHTML=t.onOffText[i].langHelp;body.appendChild(bodyText);t.accordionItems[i]=itemHeader;t.onOffItems[i]=onOffCheckbox}t.settingsDialogButtons=document.createElement("div");t.settingsDialogButtons.className="wabiLGPD-buttons";t.settingsDialog.appendChild(t.settingsDialogButtons);t.settingsConfirmButton=document.createElement("button");t.settingsConfirmButton.className="wabiLGPD-btn wabiLGPD-btn-confirm";t.settingsConfirmButton.innerHTML=t.lang.confirm;t.settingsDialogButtons.appendChild(t.settingsConfirmButton);t.settingsConsentButton=document.createElement("button");t.settingsConsentButton.className="wabiLGPD-btn wabiLGPD-btn-consent";t.settingsConsentButton.innerHTML=t.lang.consent[langModifier];t.settingsDialogButtons.appendChild(t.settingsConsentButton)};wabiLGPD.prototype.init=function(){const t=this;fetch(wabiPath+`/wabi-lgpd-1.0.lang.json`).then(response=>response.json()).then(response=>{t.lang=response[t.opt.lang];for(var i=0;i<t.onOffText.length;i++){t.onOffText[i].lang=t.lang[t.onOffText[i].id];t.onOffText[i].langHelp=t.lang[t.onOffText[i].id+"Help"]}t.init2()}).catch(error=>{console.error(`LGPD: Error loading translations`)})};wabiLGPD.prototype.init2=function(e){const t=this;if(t.opt.initialConsent&&!t.opt.showDecline&&!t.opt.showSettings){langModifier="mandatory"}else{langModifier="default"}t.newDialog();if(t.opt.showSettings){t.newSettingsDialog()}if(t.opt.analytics&&getCookie(t.opt.name+"performanceCookies")=="true")t.loadAnalytics();if(t.opt.adsense&&getCookie(t.opt.name+"targetingCookies")=="true")t.loadAdsense();if(t.showDialogButton){t.showDialogButtonClickHandler=[];for(let i=0;i<t.showDialogButton.length;i++){t.showDialogButtonClickHandler[i]=t.showDialog.bind(t);t.showDialogButton[i].addEventListener("click",t.showDialogButtonClickHandler[i])}}t.consentButtonClickHandler=t.consent.bind(t);t.consentButton.addEventListener("click",t.consentButtonClickHandler);if(t.opt.showDecline){t.declineButtonClickHandler=t.decline.bind(t);t.declineButton.addEventListener("click",t.declineButtonClickHandler)}if(t.opt.showSettings){t.settingsButtonClickHandler=t.settings.bind(t);t.settingsButton.addEventListener("click",t.settingsButtonClickHandler);if(t.opt.showSettings){t.settingsConsentButtonClickHandler=t.consent.bind(t);t.settingsConsentButton.addEventListener("click",t.settingsConsentButtonClickHandler)}t.settingsCloseButtonClickHandler=t.closeSettings.bind(t);t.settingsCloseButton.addEventListener("click",t.settingsCloseButtonClickHandler);t.settingsCloseButtonClickHandler=t.closeSettings.bind(t);t.settingsCloseButton.addEventListener("click",t.settingsCloseButtonClickHandler);t.accordionHandler=[];for(let i=0;i<t.accordionItems.length;i++){let s=t.accordionItems[i];t.accordionHandler[i]=t.toogleAccordion.bind(t,s);s.addEventListener("click",t.accordionHandler[i])}t.settingsConfirmButtonClickHandler=t.confirmChoices.bind(t);t.settingsConfirmButton.addEventListener("click",t.settingsConfirmButtonClickHandler)}if(getCookie("wabiShowDialog")=="false"){t.closeDialog()}};wabiLGPD.prototype.exit=function(){const t=this;t.container.parentNode.removeChild(t.container)};wabiLGPD.prototype.reload=function(){const t=this;t.exit();t.init()};
